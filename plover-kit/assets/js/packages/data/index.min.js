(()=>{"use strict";var e={d:(o,t)=>{for(var r in t)e.o(t,r)&&!e.o(o,r)&&Object.defineProperty(o,r,{enumerable:!0,get:t[r]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{modulesStore:()=>c,noticesStore:()=>a,useModule:()=>M,useModules:()=>v,useNotices:()=>O});const t=window.wp.data,r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var d,s=new Uint8Array(16);function l(){if(!d&&!(d="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d(s)}for(var u=[],n=0;n<256;++n)u.push((n+256).toString(16).slice(1));const i=function(e,o,t){if(r.randomUUID&&!o&&!e)return r.randomUUID();var d=(e=e||{}).random||(e.rng||l)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,o){t=t||0;for(var s=0;s<16;++s)o[t+s]=d[s];return o}return function(e,o=0){return(u[e[o+0]]+u[e[o+1]]+u[e[o+2]]+u[e[o+3]]+"-"+u[e[o+4]]+u[e[o+5]]+"-"+u[e[o+6]]+u[e[o+7]]+"-"+u[e[o+8]]+u[e[o+9]]+"-"+u[e[o+10]]+u[e[o+11]]+u[e[o+12]]+u[e[o+13]]+u[e[o+14]]+u[e[o+15]]).toLowerCase()}(d)},a="plover-kit/notices",c="plover/modules",p={notices:[]},m={name:a,options:{reducer(e=p,o){switch(o.type){case"SHOW_NOTICE":return{notices:[...e.notices,o.payload]};case"REMOVE_NOTICE":return{notices:[...e.notices].filter((({id:e})=>e!==o.uuid))}}return e},actions:{showNotice:(e,o,t=null)=>({type:"SHOW_NOTICE",payload:{id:t||i(),status:e,message:o}}),showErrorResponse:({code:e,message:o},t=null)=>({type:"SHOW_NOTICE",payload:{id:t||i(),status:"error",message:`[${e}] ${o}`}}),removeNotice:e=>({type:"REMOVE_NOTICE",uuid:e})},selectors:{getNotices:e=>e.notices}}},y=window.plover.utils,g={modules:{},groups:{}};var E;E=()=>{var e,o,r,d;(0,t.dispatch)(c).setState({modules:null!==(e=null!==(o=window?.PloverEditor?.modules)&&void 0!==o?o:window?.PloverDashboard?.modules)&&void 0!==e?e:{},groups:null!==(r=null!==(d=window?.PloverEditor?.module_groups)&&void 0!==d?d:window?.PloverDashboard?.module_groups)&&void 0!==r?r:{}})},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",E):E());const f={name:c,options:{reducer(e=g,o){switch(o.type){case"SET_GLOBAL_STATE":return{...o.payload};case"TOGGLE_MODULE":var t;return{...e,modules:{...e.modules,[o.module]:{...null!==(t=e.modules[o.module])&&void 0!==t?t:{},enabled:o.payload,dirty:!0}}};case"SET_MODUlES_DIRTY":return{...e,modules:Object.fromEntries(Object.keys(e.modules).map((o=>[o,{...e.modules[o],dirty:!1}])))};case"TOGGLE_ALL_MODULE":return{...e,modules:Object.fromEntries(Object.keys(e.modules).map((t=>[t,{...e.modules[t],enabled:o.payload,dirty:!0}])))};case"UPDATE_MODULE_FIELDS":{var r,d;const t=null!==(r=e.modules[o.module])&&void 0!==r?r:{},s=Object.fromEntries(Object.keys(o.payload).map((e=>{var r;const d=o.payload[e];return[e,{...null!==(r=t?.fields[e])&&void 0!==r?r:{},value:d}]})));return{...e,modules:{...e.modules,[o.module]:{...t,fields_dirty:!0,fields:{...null!==(d=t?.fields)&&void 0!==d?d:{},...s}}}}}case"SET_MODUlE_FIELDS_DIRTY":{var s;const t=null!==(s=e.modules[o.module])&&void 0!==s?s:{};return{...e,modules:{...e.modules,[o.module]:{...t,fields_dirty:o.payload}}}}}return e},actions:{setState:e=>({type:"SET_GLOBAL_STATE",payload:e}),setModulesDirty:e=>({type:"SET_MODUlES_DIRTY",payload:e}),setModuleFieldsDirty:(e,o)=>({type:"SET_MODUlE_FIELDS_DIRTY",module:e,payload:o}),updateModuleFields:(e,o)=>({type:"UPDATE_MODULE_FIELDS",module:e,payload:o}),toggleModule:(e,o)=>({type:"TOGGLE_MODULE",module:e,payload:o}),toggleAllModule:e=>({type:"TOGGLE_ALL_MODULE",payload:e})},selectors:{getModules:e=>(0,y.flattenObject)(e.modules).sort(((e,o)=>o?.order-e?.order)).map((e=>({...e,fields:(0,y.flattenObject)(e?.fields)}))),getModuleGroups:e=>(0,y.flattenObject)(e.groups).sort(((e,o)=>e?.order-o?.order)),getModule:(e,o)=>({...e.modules[o],fields:(0,y.flattenObject)(e.modules[o]?.fields)}),getModuleFields:(e,o)=>(0,y.flattenObject)(e.modules[o]?.fields),isModuleEnabled:(e,o)=>e.modules[o]?.enabled}}};function O(){const e=(0,t.useSelect)((function(e){return e(a).getNotices()}),[]),{showNotice:o,removeNotice:r,showErrorResponse:d}=(0,t.useDispatch)(a);return{showNotice:o,showTimeoutNotice:(e,t,d=5e3)=>{const s=i();o(e,t,s),d>0&&setTimeout((()=>{r(s)}),d)},showErrorResponse:(...e)=>(d(...e),Promise.reject()),showTimeoutErrorResponse:(e,o=8e3)=>{const t=i();return d(e,t),o>0&&setTimeout((()=>{r(t)}),o),Promise.reject()},removeNotice:r,notices:e}}function M(e){let o=(0,t.useSelect)((o=>o(c).getModule(e)),[]);const{updateModuleFields:r,toggleModule:d,setModuleFieldsDirty:s}=(0,t.useDispatch)(c);return{moduleData:o?{...o,id:e}:null,updateModuleFields:(...o)=>{r(e,...o)},toggleModule:(...o)=>{d(e,...o)},setModuleFieldsDirty:(...o)=>{s(e,...o)}}}function v(){const{modules:e,groups:o}=(0,t.useSelect)((e=>({modules:e(c).getModules(),groups:e(c).getModuleGroups()})),[]),r={};e.forEach((e=>{var t;const d=o.find((({id:o})=>o===e?.group)),s=null!==(t=d?.id)&&void 0!==t?t:"default";r[s]||(r[s]=[]),r[s].push(e)}));const{toggleModule:d,toggleAllModule:s,setModulesDirty:l}=(0,t.useDispatch)(c);return{modules:e,groups:o,modulesByGroup:r,setModulesDirty:l,toggleModule:d,toggleAllModule:s}}t.register?((0,t.register)((0,t.createReduxStore)(m.name,m.options)),(0,t.register)((0,t.createReduxStore)(f.name,f.options))):((0,t.registerStore)(m.name,m.options),(0,t.registerStore)(f.name,f.options)),(window.ploverKit=window.ploverKit||{}).data=o})();