(()=>{"use strict";const e=window.wp.hooks,t=window.wp.blockEditor,o=window.wp.components,s=window.wp.i18n,l=window.wp.element,r=window.wp.data,n=window.plover.data,a=window.ReactJSXRuntime;function p({postType:e,onChange:t}){const{postTypes:p}=(0,r.useSelect)((e=>{const{getPostTypes:t}=e(n.coreStore),o=["attachment"],s=t({per_page:-1})?.filter((({viewable:e,slug:t})=>e&&!o.includes(t)));return{postTypes:s}}),[]),i=(0,l.useMemo)((()=>[{label:(0,s.__)("All","plover"),value:""},...(p||[]).map((({labels:e,slug:t})=>({label:e.name,value:t})))]),[p]);return(0,a.jsx)(o.SelectControl,{label:(0,s.__)("Post Type","plover"),value:e,options:i,onChange:t})}function i(r){const{attributes:n,setAttributes:i}=r,{postType:c}=n,u=(0,e.applyFilters)("plover.searchFilters",[{attr:"postType",label:(0,s.__)("Post Type","plover"),isShownByDefault:!0,control:(0,a.jsx)(p,{postType:c,onChange:e=>{i({postType:e})}})}],r),[w,d]=(0,l.useState)({});return(0,a.jsx)(t.InspectorControls,{children:(0,a.jsx)(o.__experimentalToolsPanel,{label:(0,s.__)("Filters","plover"),resetAll:()=>{d({})},children:u.map((({attr:e,label:t,control:s,isShownByDefault:l})=>(0,a.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>!!w[e],label:t,onDeselect:()=>{d({...w,attr:void 0})},isShownByDefault:l||n[e],children:s},e)))})})}(0,e.addFilter)("blocks.registerBlockType","plover/search-attributes",((e,t)=>("core/search"===t&&(e.attributes={...e.attributes,postType:{type:"string"}}),e))),(0,e.addFilter)("editor.BlockEdit","plover/search-controls",(e=>t=>{const{attributes:o,isSelected:s,name:l}=t;return"core/search"!==l?(0,a.jsx)(e,{...t}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e,{...t}),(0,a.jsx)(i,{...t})]})}))})();